import{d as k,b as S,o as f,c as g,F as W,e as q,n as Q,w as Y,t as w,_ as I,f as Z,v as ee,g as j,p as te,h as ne,u as ae,i as oe,j as b,k as re,a as se,l as E,m as ie}from"./index-435a39e9.js";import{a as L}from"./index-a740f847.js";const ce={class:"ui-pagination"},le=["onClick"],ue={name:"UiPagination"},de=k({...ue,props:{perPage:{},totalCount:{},currentPage:{},offset:{default:2}},emits:["changePage"],setup(e,{emit:t}){const a=e,d=S(()=>Math.ceil(a.totalCount/a.perPage)),c=S(()=>{const r=[];for(let n=1;n<=d.value;n++)(a.currentPage-n<a.offset&&a.currentPage-n>-a.offset||n===d.value||n===1)&&r.push(n);return r}),_=r=>{t("changePage",r)};return(r,n)=>(f(),g("ul",ce,[(f(!0),g(W,null,q(c.value,l=>(f(),g("li",{class:Q(["ui-pagination__item",{"ui-pagination__item--active":a.currentPage===l}]),key:l,onClick:Y(p=>_(l),["prevent"])},w(l),11,le))),128))]))}});const _e=I(de,[["__scopeId","data-v-28b47067"]]),fe={class:"search"},pe=k({__name:"PostFilter",props:{modelValue:{}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,d=S({get(){return a.modelValue},set(c){t("update:modelValue",c)}});return(c,_)=>(f(),g("div",fe,[Z(j("input",{class:"search__control",type:"search","onUpdate:modelValue":_[0]||(_[0]=r=>d.value=r),placeholder:"author..."},null,512),[[ee,d.value]])]))}});const ge=I(pe,[["__scopeId","data-v-01b7328d"]]),ve={class:"post-item"},me={class:"post-item__title"},be={class:"post-item__body"},ye={class:"post-item__author"},he=k({__name:"PostItem",props:{post:{}},setup(e){return(t,a)=>(f(),g("article",ve,[j("h3",me,w(t.post.title),1),j("div",be,w(t.post.body),1),j("div",ye,w(t.post.author),1)]))}});const Pe=I(he,[["__scopeId","data-v-dd6dea8f"]]);const Te={},$e=e=>(te("data-v-c12b7f7b"),e=e(),ne(),e),je={class:"lds-circle"},Se=$e(()=>j("div",null,null,-1)),Ie=[Se];function Oe(e,t){return f(),g("div",je,Ie)}const we=I(Te,[["render",Oe],["__scopeId","data-v-c12b7f7b"]]);var O=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ke(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function xe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var A=xe,Ce=typeof O=="object"&&O&&O.Object===Object&&O,Ue=Ce,Ee=Ue,Ne=typeof self=="object"&&self&&self.Object===Object&&self,Ve=Ee||Ne||Function("return this")(),z=Ve,Le=z,Fe=function(){return Le.Date.now()},Me=Fe,Ge=/\s/;function Re(e){for(var t=e.length;t--&&Ge.test(e.charAt(t)););return t}var Be=Re,De=Be,We=/^\s+/;function qe(e){return e&&e.slice(0,De(e)+1).replace(We,"")}var Ae=qe,ze=z,He=ze.Symbol,H=He,F=H,X=Object.prototype,Xe=X.hasOwnProperty,Je=X.toString,$=F?F.toStringTag:void 0;function Ke(e){var t=Xe.call(e,$),a=e[$];try{e[$]=void 0;var d=!0}catch{}var c=Je.call(e);return d&&(t?e[$]=a:delete e[$]),c}var Qe=Ke,Ye=Object.prototype,Ze=Ye.toString;function et(e){return Ze.call(e)}var tt=et,M=H,nt=Qe,at=tt,ot="[object Null]",rt="[object Undefined]",G=M?M.toStringTag:void 0;function st(e){return e==null?e===void 0?rt:ot:G&&G in Object(e)?nt(e):at(e)}var it=st;function ct(e){return e!=null&&typeof e=="object"}var lt=ct,ut=it,dt=lt,_t="[object Symbol]";function ft(e){return typeof e=="symbol"||dt(e)&&ut(e)==_t}var pt=ft,gt=Ae,R=A,vt=pt,B=0/0,mt=/^[-+]0x[0-9a-f]+$/i,bt=/^0b[01]+$/i,yt=/^0o[0-7]+$/i,ht=parseInt;function Pt(e){if(typeof e=="number")return e;if(vt(e))return B;if(R(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=R(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=gt(e);var a=bt.test(e);return a||yt.test(e)?ht(e.slice(2),a?2:8):mt.test(e)?B:+e}var Tt=Pt,$t=A,N=Me,D=Tt,jt="Expected a function",St=Math.max,It=Math.min;function Ot(e,t,a){var d,c,_,r,n,l,p=0,y=!1,m=!1,h=!0;if(typeof e!="function")throw new TypeError(jt);t=D(t)||0,$t(a)&&(y=!!a.leading,m="maxWait"in a,_=m?St(D(a.maxWait)||0,t):_,h="trailing"in a?!!a.trailing:h);function P(i){var v=d,T=c;return d=c=void 0,p=i,r=e.apply(T,v),r}function x(i){return p=i,n=setTimeout(s,t),y?P(i):r}function C(i){var v=i-l,T=i-p,V=t-v;return m?It(V,_-T):V}function o(i){var v=i-l,T=i-p;return l===void 0||v>=t||v<0||m&&T>=_}function s(){var i=N();if(o(i))return u(i);n=setTimeout(s,C(i))}function u(i){return n=void 0,h&&d?P(i):(d=c=void 0,r)}function J(){n!==void 0&&clearTimeout(n),p=0,d=l=c=n=void 0}function K(){return n===void 0?r:u(N())}function U(){var i=N(),v=o(i);if(d=arguments,c=this,l=i,v){if(n===void 0)return x(l);if(m)return clearTimeout(n),n=setTimeout(s,t),P(l)}return n===void 0&&(n=setTimeout(s,t)),r}return U.cancel=J,U.flush=K,U}var wt=Ot;const kt=ke(wt),xt={class:"posts-page"},Ct={key:1,class:"posts-page__list"},Ut={key:2,class:"posts-page__not-found"},Et=k({__name:"PostsPage",setup(e){const t=ae(),a=oe(),d=b([]),c=b([]),_=b(""),r=b(!1),n=b({perPage:10,totalCount:100}),l=b(a.query.page?+a.query.page:1),p=b([]),y=async()=>{r.value=!0;try{const o={filters:{userId:p.value},pagination:{limit:n.value.perPage,currentPage:l.value}},{total:s,data:u}=await L.posts.getPosts(o);d.value=u,n.value.totalCount=+s}catch(o){console.log(o)}finally{r.value=!1}},m=async()=>{try{const{data:o}=await L.users.getUsers();c.value=o,p.value=c.value.map(s=>s.id)}catch(o){console.error(o)}},h=S(()=>{var o;return c.value?(o=c.value)==null?void 0:o.reduce((s,u)=>(s[u.id]=u,s),{}):[]}),P=S(()=>{var o;return(o=d.value)==null?void 0:o.map(s=>{const u=h.value[s.userId];return{...s,author:u==null?void 0:u.name}})}),x=o=>{l.value=o,t.push({query:{page:l.value}}),y(),window.scrollTo(0,0)};Promise.all([m(),y()]);const C=kt(y,400);return re(_,()=>{p.value=c.value.filter(o=>o.name.toLowerCase().includes(_.value.toLowerCase())).map(o=>o.id),t.push({query:{page:1}}),l.value=1,C()}),(o,s)=>(f(),g("div",xt,[se(ge,{class:"posts-page__filter",modelValue:_.value,"onUpdate:modelValue":s[0]||(s[0]=u=>_.value=u)},null,8,["modelValue"]),r.value?(f(),E(we,{key:0})):!r.value&&p.value.length?(f(),g("div",Ct,[(f(!0),g(W,null,q(P.value,u=>(f(),E(Pe,{class:"post-page__item",key:u.id,post:u},null,8,["post"]))),128))])):(f(),g("small",Ut,"NOT FOUND")),p.value.length?(f(),E(_e,{key:3,class:"posts-page__pagination",currentPage:l.value,perPage:n.value.perPage,totalCount:n.value.totalCount,onChangePage:s[1]||(s[1]=u=>x(u))},null,8,["currentPage","perPage","totalCount"])):ie("",!0)]))}});const Lt=I(Et,[["__scopeId","data-v-4b3e6ecd"]]);export{Lt as default};
