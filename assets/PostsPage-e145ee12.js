import{d as w,b as j,o as p,c as g,F as W,e as q,n as Q,w as Y,t as S,_ as k,f as Z,v as ee,g as I,u as te,h as ne,i as b,j as ae,a as re,k as L,l as oe}from"./index-1c1a9724.js";import{a as U}from"./index-a740f847.js";const se={class:"ui-pagination"},ie=["onClick"],le={name:"UiPagination"},ue=w({...le,props:{perPage:{},totalCount:{},currentPage:{},offset:{default:2}},emits:["changePage"],setup(e,{emit:t}){const a=e,c=j(()=>Math.ceil(a.totalCount/a.perPage)),i=j(()=>{const d=[];for(let n=1;n<=c.value;n++)(a.currentPage-n<a.offset&&a.currentPage-n>-a.offset||n===c.value||n===1)&&d.push(n);return d}),f=d=>{t("changePage",d)};return(d,n)=>(p(),g("ul",se,[(p(!0),g(W,null,q(i.value,l=>(p(),g("li",{class:Q(["ui-pagination__item",{"ui-pagination__item--active":a.currentPage===l}]),key:l,onClick:Y(_=>f(l),["prevent"])},S(l),11,ie))),128))]))}});const ce=k(ue,[["__scopeId","data-v-28b47067"]]),de={class:"search"},fe=w({__name:"PostFilter",props:{modelValue:{}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,c=j({get(){return a.modelValue},set(i){t("update:modelValue",i)}});return(i,f)=>(p(),g("div",de,[Z(I("input",{class:"search__control",type:"search","onUpdate:modelValue":f[0]||(f[0]=d=>c.value=d),placeholder:"author..."},null,512),[[ee,c.value]])]))}});const _e=k(fe,[["__scopeId","data-v-01b7328d"]]),pe={class:"post-item"},ge={class:"post-item__title"},me={class:"post-item__body"},ve={class:"post-item__author"},be=w({__name:"PostItem",props:{post:{}},setup(e){return(t,a)=>(p(),g("article",pe,[I("h3",ge,S(t.post.title),1),I("div",me,S(t.post.body),1),I("div",ve,S(t.post.author),1)]))}});const ye=k(be,[["__scopeId","data-v-dd6dea8f"]]);var O=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function he(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Pe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var A=Pe,Te=typeof O=="object"&&O&&O.Object===Object&&O,$e=Te,je=$e,Oe=typeof self=="object"&&self&&self.Object===Object&&self,Se=je||Oe||Function("return this")(),z=Se,Ie=z,we=function(){return Ie.Date.now()},ke=we,Ce=/\s/;function xe(e){for(var t=e.length;t--&&Ce.test(e.charAt(t)););return t}var Ee=xe,Ne=Ee,Ve=/^\s+/;function Le(e){return e&&e.slice(0,Ne(e)+1).replace(Ve,"")}var Ue=Le,Fe=z,Me=Fe.Symbol,H=Me,F=H,X=Object.prototype,Ge=X.hasOwnProperty,Re=X.toString,$=F?F.toStringTag:void 0;function Be(e){var t=Ge.call(e,$),a=e[$];try{e[$]=void 0;var c=!0}catch{}var i=Re.call(e);return c&&(t?e[$]=a:delete e[$]),i}var De=Be,We=Object.prototype,qe=We.toString;function Ae(e){return qe.call(e)}var ze=Ae,M=H,He=De,Xe=ze,Je="[object Null]",Ke="[object Undefined]",G=M?M.toStringTag:void 0;function Qe(e){return e==null?e===void 0?Ke:Je:G&&G in Object(e)?He(e):Xe(e)}var Ye=Qe;function Ze(e){return e!=null&&typeof e=="object"}var et=Ze,tt=Ye,nt=et,at="[object Symbol]";function rt(e){return typeof e=="symbol"||nt(e)&&tt(e)==at}var ot=rt,st=Ue,R=A,it=ot,B=0/0,lt=/^[-+]0x[0-9a-f]+$/i,ut=/^0b[01]+$/i,ct=/^0o[0-7]+$/i,dt=parseInt;function ft(e){if(typeof e=="number")return e;if(it(e))return B;if(R(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=R(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=st(e);var a=ut.test(e);return a||ct.test(e)?dt(e.slice(2),a?2:8):lt.test(e)?B:+e}var _t=ft,pt=A,N=ke,D=_t,gt="Expected a function",mt=Math.max,vt=Math.min;function bt(e,t,a){var c,i,f,d,n,l,_=0,y=!1,v=!1,h=!0;if(typeof e!="function")throw new TypeError(gt);t=D(t)||0,pt(a)&&(y=!!a.leading,v="maxWait"in a,f=v?mt(D(a.maxWait)||0,t):f,h="trailing"in a?!!a.trailing:h);function P(s){var m=c,T=i;return c=i=void 0,_=s,d=e.apply(T,m),d}function C(s){return _=s,n=setTimeout(o,t),y?P(s):d}function x(s){var m=s-l,T=s-_,V=t-m;return v?vt(V,f-T):V}function r(s){var m=s-l,T=s-_;return l===void 0||m>=t||m<0||v&&T>=f}function o(){var s=N();if(r(s))return u(s);n=setTimeout(o,x(s))}function u(s){return n=void 0,h&&c?P(s):(c=i=void 0,d)}function J(){n!==void 0&&clearTimeout(n),_=0,c=l=i=n=void 0}function K(){return n===void 0?d:u(N())}function E(){var s=N(),m=r(s);if(c=arguments,i=this,l=s,m){if(n===void 0)return C(l);if(v)return clearTimeout(n),n=setTimeout(o,t),P(l)}return n===void 0&&(n=setTimeout(o,t)),d}return E.cancel=J,E.flush=K,E}var yt=bt;const ht=he(yt),Pt={class:"posts-page"},Tt={key:0,class:"posts-page__list"},$t={key:1,class:"posts-page__not-found"},jt=w({__name:"PostsPage",setup(e){const t=te(),a=ne(),c=b([]),i=b([]),f=b(""),d=b(!1),n=b({perPage:10,totalCount:100}),l=b(a.query.page?+a.query.page:1),_=b([]),y=async()=>{d.value=!0;try{const r={filters:{userId:_.value},pagination:{limit:n.value.perPage,currentPage:l.value}},{total:o,data:u}=await U.posts.getPosts(r);c.value=u,n.value.totalCount=+o}catch(r){console.log(r)}finally{d.value=!1}},v=async()=>{try{const{data:r}=await U.users.getUsers();i.value=r,_.value=i.value.map(o=>o.id)}catch(r){console.error(r)}},h=j(()=>{var r;return i.value?(r=i.value)==null?void 0:r.reduce((o,u)=>(o[u.id]=u,o),{}):[]}),P=j(()=>{var r;return(r=c.value)==null?void 0:r.map(o=>{const u=h.value[o.userId];return{...o,author:u==null?void 0:u.name}})}),C=r=>{l.value=r,t.push({query:{page:l.value}}),y(),window.scrollTo(0,0)};Promise.all([v(),y()]);const x=ht(y,400);return ae(f,()=>{_.value=i.value.filter(r=>r.name.toLowerCase().includes(f.value.toLowerCase())).map(r=>r.id),t.push({query:{page:1}}),l.value=1,x()}),(r,o)=>(p(),g("div",Pt,[re(_e,{class:"posts-page__filter",modelValue:f.value,"onUpdate:modelValue":o[0]||(o[0]=u=>f.value=u)},null,8,["modelValue"]),_.value.length?(p(),g("div",Tt,[(p(!0),g(W,null,q(P.value,u=>(p(),L(ye,{class:"post-page__item",key:u.id,post:u},null,8,["post"]))),128))])):(p(),g("small",$t,"NOT FOUND")),_.value.length?(p(),L(ce,{key:2,class:"posts-page__pagination",currentPage:l.value,perPage:n.value.perPage,totalCount:n.value.totalCount,onChangePage:o[1]||(o[1]=u=>C(u))},null,8,["currentPage","perPage","totalCount"])):oe("",!0)]))}});const It=k(jt,[["__scopeId","data-v-b1e00947"]]);export{It as default};
